import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as n,o as t}from"./app-D83PqN3g.js";const h={};function l(e,i){return t(),a("div",null,[...i[0]||(i[0]=[n(`<h1 id="èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯"><span>èƒŒæ™¯</span></a></h1><p><a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">https://pytorch.org/</a></p><h1 id="chat" tabindex="-1"><a class="header-anchor" href="#chat"><span>chat</span></a></h1><h2 id="æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#æ˜¯ä»€ä¹ˆ"><span>æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h2><p>æˆ‘æ¥ç³»ç»Ÿã€æ˜“æ‡‚åœ°å¸®ä½ ä»‹ç»ä¸€ä¸‹ <strong>PyTorch</strong> â€”â€” å®ƒæ˜¯å‡ ä¹æ‰€æœ‰å¤§æ¨¡å‹ï¼ˆLLMï¼‰å¼€å‘è€…éƒ½è¦æŒæ¡çš„æ ¸å¿ƒæ¡†æ¶ã€‚</p><hr><h2 id="ğŸ’¡-ä¸€ã€pytorch-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#ğŸ’¡-ä¸€ã€pytorch-æ˜¯ä»€ä¹ˆ"><span>ğŸ’¡ ä¸€ã€PyTorch æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h2><blockquote><p>PyTorch æ˜¯ä¸€ä¸ª <strong>åŸºäº Python çš„æ·±åº¦å­¦ä¹ æ¡†æ¶</strong>ï¼Œç”± Facebookï¼ˆç°åœ¨çš„ Metaï¼‰AI ç ”ç©¶é™¢åœ¨ 2016 å¹´å‘å¸ƒã€‚<br> å®ƒä¸»è¦ç”¨äºï¼š</p><ul><li><strong>æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹</strong></li><li><strong>è¿›è¡Œ GPU åŠ é€Ÿè®­ç»ƒ</strong></li><li><strong>å®ç°çµæ´»çš„ç§‘å­¦è®¡ç®—å’Œè‡ªåŠ¨å¾®åˆ†</strong></li></ul></blockquote><p>ä¸€å¥è¯æ¦‚æ‹¬ï¼š</p><blockquote><p><strong>PyTorch = æ•°å­¦è®¡ç®—ï¼ˆåƒ NumPyï¼‰ + è‡ªåŠ¨æ±‚å¯¼ï¼ˆAutogradï¼‰ + ç¥ç»ç½‘ç»œæ¨¡å—ï¼ˆnnï¼‰ + GPU åŠ é€Ÿ</strong></p></blockquote><hr><h2 id="ğŸ§±-äºŒã€pytorch-çš„æ ¸å¿ƒç»„æˆæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#ğŸ§±-äºŒã€pytorch-çš„æ ¸å¿ƒç»„æˆæ¨¡å—"><span>ğŸ§± äºŒã€PyTorch çš„æ ¸å¿ƒç»„æˆæ¨¡å—</span></a></h2><p>PyTorch å…¶å®å¯ä»¥æ‹†æˆå‡ ä¸ªå…³é”®éƒ¨åˆ†ï¼š</p><h3 id="_1ï¸âƒ£-tensor-å¼ é‡" tabindex="-1"><a class="header-anchor" href="#_1ï¸âƒ£-tensor-å¼ é‡"><span>1ï¸âƒ£ <strong>Tensor å¼ é‡</strong></span></a></h3><ul><li>ç±»ä¼¼äº NumPy çš„å¤šç»´æ•°ç»„ï¼Œä½†å¯ä»¥åœ¨ GPU ä¸Šè¿è¡Œã€‚</li><li>æ˜¯æ•´ä¸ª PyTorch çš„ã€Œæ•°æ®åŸºçŸ³ã€ã€‚</li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">dtype</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">torch.float32)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x.device)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é»˜è®¤æ˜¯ CPU</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ ä¹Ÿå¯ä»¥ç›´æ¥æŠŠå®ƒæ”¾åœ¨ GPU ä¸Šï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">to</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;cuda&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h3 id="_2ï¸âƒ£-autograd-è‡ªåŠ¨æ±‚å¯¼" tabindex="-1"><a class="header-anchor" href="#_2ï¸âƒ£-autograd-è‡ªåŠ¨æ±‚å¯¼"><span>2ï¸âƒ£ <strong>Autogradï¼ˆè‡ªåŠ¨æ±‚å¯¼ï¼‰</strong></span></a></h3><ul><li>è‡ªåŠ¨è®¡ç®—æ¢¯åº¦ï¼ˆç”¨äºè®­ç»ƒç¥ç»ç½‘ç»œæ—¶çš„åå‘ä¼ æ’­ï¼‰ã€‚</li><li>ä¸éœ€è¦æ‰‹åŠ¨å†™å¾®åˆ†å…¬å¼ã€‚</li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">requires_grad</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">**</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">backward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è‡ªåŠ¨è®¡ç®— dy/dx</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x.grad)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¾“å‡ºï¼š7.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="_3ï¸âƒ£-nn-ç¥ç»ç½‘ç»œæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_3ï¸âƒ£-nn-ç¥ç»ç½‘ç»œæ¨¡å—"><span>3ï¸âƒ£ <strong>nnï¼ˆç¥ç»ç½‘ç»œæ¨¡å—ï¼‰</strong></span></a></h3><ul><li><p>æä¾›å„ç§ç¥ç»ç½‘ç»œçš„åŸºæœ¬ç»„ä»¶ï¼Œæ¯”å¦‚ï¼š</p><ul><li><code>nn.Linear</code>ï¼ˆå…¨è¿æ¥å±‚ï¼‰</li><li><code>nn.Conv2d</code>ï¼ˆå·ç§¯å±‚ï¼‰</li><li><code>nn.LSTM</code>ï¼ˆå¾ªç¯ç¥ç»ç½‘ç»œï¼‰</li><li><code>nn.Transformer</code>ï¼ˆå¤§æ¨¡å‹æ ¸å¿ƒæ¶æ„ï¼‰</li></ul></li><li><p>ä½ å¯ä»¥åƒæ‹¼ç§¯æœ¨ä¸€æ ·æ­å»ºæ¨¡å‹ï¼š</p></li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.nn </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> SimpleNet</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">nn</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Module</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.linear </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> forward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> x</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">model </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> SimpleNet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(model)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="_4ï¸âƒ£-ä¼˜åŒ–å™¨-torch-optim" tabindex="-1"><a class="header-anchor" href="#_4ï¸âƒ£-ä¼˜åŒ–å™¨-torch-optim"><span>4ï¸âƒ£ <strong>ä¼˜åŒ–å™¨ï¼ˆtorch.optimï¼‰</strong></span></a></h3><ul><li><p>ç”¨æ¥æ›´æ–°æ¨¡å‹å‚æ•°ï¼Œè®©æŸå¤±å‡½æ•°å˜å°ã€‚</p></li><li><p>å¸¸è§ä¼˜åŒ–å™¨æœ‰ï¼š</p><ul><li><code>SGD</code></li><li><code>Adam</code></li><li><code>RMSProp</code></li></ul></li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">optimizer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.optim.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Adam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">parameters</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">lr</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.001</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h3 id="_5ï¸âƒ£-æŸå¤±å‡½æ•°-torch-nn-functional-æˆ–-nn-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_5ï¸âƒ£-æŸå¤±å‡½æ•°-torch-nn-functional-æˆ–-nn-æ¨¡å—"><span>5ï¸âƒ£ <strong>æŸå¤±å‡½æ•°ï¼ˆtorch.nn.functional æˆ– nn æ¨¡å—ï¼‰</strong></span></a></h3><ul><li><p>è¡¡é‡é¢„æµ‹ä¸çœŸå®ç»“æœçš„å·®è·ï¼Œæ¯”å¦‚ï¼š</p><ul><li><code>nn.MSELoss</code>ï¼ˆå›å½’ï¼‰</li><li><code>nn.CrossEntropyLoss</code>ï¼ˆåˆ†ç±»ï¼‰</li><li><code>nn.BCELoss</code>ï¼ˆäºŒåˆ†ç±»ï¼‰</li></ul></li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">criterion </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">CrossEntropyLoss</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h3 id="_6ï¸âƒ£-dataloader-dataset" tabindex="-1"><a class="header-anchor" href="#_6ï¸âƒ£-dataloader-dataset"><span>6ï¸âƒ£ <strong>DataLoader / Dataset</strong></span></a></h3><ul><li>è´Ÿè´£åŠ è½½å’Œæ‰¹é‡å¤„ç†è®­ç»ƒæ•°æ®ã€‚</li><li>å¯ä»¥è‡ªå®šä¹‰ <code>Dataset</code> ç»§æ‰¿ç±»ï¼Œå®ç°æ•°æ®è¯»å–é€»è¾‘ã€‚</li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.utils.data </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> DataLoader, Dataset</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyDataset</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Dataset</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.data </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __getitem__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> idx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.data[idx]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __len__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.data)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">loader </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> DataLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">MyDataset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]), </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">batch_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="ğŸš€-ä¸‰ã€pytorch-çš„è®­ç»ƒæµç¨‹" tabindex="-1"><a class="header-anchor" href="#ğŸš€-ä¸‰ã€pytorch-çš„è®­ç»ƒæµç¨‹"><span>ğŸš€ ä¸‰ã€PyTorch çš„è®­ç»ƒæµç¨‹</span></a></h2><p>å®Œæ•´çš„è®­ç»ƒæµç¨‹åŸºæœ¬å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> epoch </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(num_epochs):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> batch </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dataloader:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        optimizer.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">zero_grad</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()     </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¸…ç©ºæ¢¯åº¦</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        outputs </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(batch)    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å‰å‘ä¼ æ’­</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> criterion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(outputs, labels)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¡ç®—æŸå¤±</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        loss.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">backward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()           </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        optimizer.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">step</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()          </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ›´æ–°å‚æ•°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ˜¯æ‰€æœ‰ç¥ç»ç½‘ç»œè®­ç»ƒçš„é€šç”¨å¥—è·¯ã€‚</p><hr><h2 id="âš¡-å››ã€pytorch-çš„ä¼˜åŠ¿" tabindex="-1"><a class="header-anchor" href="#âš¡-å››ã€pytorch-çš„ä¼˜åŠ¿"><span>âš¡ å››ã€PyTorch çš„ä¼˜åŠ¿</span></a></h2><p>âœ… <strong>åŠ¨æ€å›¾æœºåˆ¶ï¼ˆDynamic Graphï¼‰</strong></p><ul><li>è®¡ç®—å›¾æ˜¯å³æ—¶æ„å»ºçš„ï¼Œå†™èµ·æ¥æ›´åƒæ™®é€š Python ä»£ç ã€‚</li><li>æ¯” TensorFlowï¼ˆæ—§ç‰ˆæœ¬ï¼‰çµæ´»ï¼Œéå¸¸é€‚åˆç ”ç©¶å’Œå®éªŒã€‚</li></ul><p>âœ… <strong>GPU åŠ é€Ÿç®€å•</strong></p><ul><li>åªéœ€ä¸€è¡Œ <code>.to(&#39;cuda&#39;)</code>ï¼Œè®¡ç®—å…¨åŠ é€Ÿã€‚</li></ul><p>âœ… <strong>ç”Ÿæ€ä¸°å¯Œ</strong></p><ul><li><p>å¤§é‡é¢„è®­ç»ƒæ¨¡å‹å¯ç›´æ¥åŠ è½½ï¼š</p><ul><li>æ¥è‡ª Hugging Face Transformers</li><li>torchvisionï¼ˆå›¾åƒï¼‰</li><li>torchaudioï¼ˆè¯­éŸ³ï¼‰</li><li>torchtextï¼ˆNLPï¼‰</li></ul></li></ul><p>âœ… <strong>ç¤¾åŒºå¼ºå¤§</strong></p><ul><li>å‡ ä¹æ‰€æœ‰æ·±åº¦å­¦ä¹ è®ºæ–‡çš„å¼€æºå®ç°éƒ½æ”¯æŒ PyTorchã€‚</li></ul><hr><h2 id="ğŸ“˜-äº”ã€å…¥é—¨å­¦ä¹ å»ºè®®" tabindex="-1"><a class="header-anchor" href="#ğŸ“˜-äº”ã€å…¥é—¨å­¦ä¹ å»ºè®®"><span>ğŸ“˜ äº”ã€å…¥é—¨å­¦ä¹ å»ºè®®</span></a></h2><p>å¦‚æœä½ æƒ³ç³»ç»Ÿå­¦ PyTorchï¼Œå¯ä»¥æŒ‰è¿™ä¸ªè·¯å¾„èµ°ï¼š</p><ol><li><p><strong>å®˜æ–¹æ•™ç¨‹</strong>ï¼ˆå¼ºçƒˆæ¨èï¼‰<br> ğŸ‘‰ <a href="https://pytorch.org/tutorials/" target="_blank" rel="noopener noreferrer">https://pytorch.org/tutorials/</a></p></li><li><p><strong>ä¸­æ–‡æ•™å­¦ä¹¦ç±</strong></p><ul><li>ã€ŠåŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹  PyTorch ç‰ˆã€‹ï¼ˆææ²ç­‰ï¼‰</li><li>ã€Šæ·±åº¦å­¦ä¹ å…¥é—¨ï¼šåŸºäº PyTorchã€‹</li></ul></li><li><p><strong>å®è·µé¡¹ç›®å»ºè®®</strong></p><ul><li>å®ç°ä¸€ä¸ªæ‰‹å†™æ•°å­—è¯†åˆ«ï¼ˆMNISTï¼‰</li><li>æ­ä¸€ä¸ªæƒ…æ„Ÿåˆ†ç±»ï¼ˆNLPï¼‰</li><li>è®­ç»ƒä¸€ä¸ª Transformer æ–‡æœ¬ç”Ÿæˆå°æ¨¡å‹</li></ul></li></ol><hr><h2 id="ğŸ§ -æ€»ç»“ä¸€å¥è¯" tabindex="-1"><a class="header-anchor" href="#ğŸ§ -æ€»ç»“ä¸€å¥è¯"><span>ğŸ§  æ€»ç»“ä¸€å¥è¯ï¼š</span></a></h2><blockquote><p>PyTorch æ˜¯æ·±åº¦å­¦ä¹ å’Œå¤§æ¨¡å‹çš„â€œé€šç”¨è¯­è¨€â€ï¼ŒæŒæ¡å®ƒ = æ‰“å¼€ LLM ä¸–ç•Œçš„ç¬¬ä¸€é“é—¨ã€‚<br> ä»ç®€å•çš„å¼ é‡è¿ç®—ï¼Œåˆ°æ„å»º Transformerï¼Œåªè¦ç†è§£ PyTorch çš„è®¡ç®—é€»è¾‘ï¼Œåç»­å­¦ Hugging Faceã€å¾®è°ƒ LLMã€éƒ¨ç½²æ¨¡å‹éƒ½ä¼šéå¸¸é¡ºç•…ã€‚</p></blockquote>`,60)])])}const r=s(h,[["render",l]]),d=JSON.parse('{"path":"/posts/learn-llms/2025-11-03-dive-into-llms-05-pytorch-01-intro.html","title":"dive-into-llms-05-PyTorch å…¥é—¨ä»‹ç»","lang":"zh-CN","frontmatter":{"title":"dive-into-llms-05-PyTorch å…¥é—¨ä»‹ç»","date":"2025-11-03T00:00:00.000Z","categories":["AI"],"tags":["ai","learn-note"],"published":true,"description":"èƒŒæ™¯ https://pytorch.org/ chat æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘æ¥ç³»ç»Ÿã€æ˜“æ‡‚åœ°å¸®ä½ ä»‹ç»ä¸€ä¸‹ PyTorch â€”â€” å®ƒæ˜¯å‡ ä¹æ‰€æœ‰å¤§æ¨¡å‹ï¼ˆLLMï¼‰å¼€å‘è€…éƒ½è¦æŒæ¡çš„æ ¸å¿ƒæ¡†æ¶ã€‚ ğŸ’¡ ä¸€ã€PyTorch æ˜¯ä»€ä¹ˆï¼Ÿ PyTorch æ˜¯ä¸€ä¸ª åŸºäº Python çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œç”± Facebookï¼ˆç°åœ¨çš„ Metaï¼‰AI ç ”ç©¶é™¢åœ¨ 2016 å¹´å‘å¸ƒã€‚ å®ƒä¸»è¦...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"dive-into-llms-05-PyTorch å…¥é—¨ä»‹ç»\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-11-03T00:00:00.000Z\\",\\"dateModified\\":\\"2025-12-27T05:15:15.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"è€é©¬å•¸è¥¿é£\\",\\"url\\":\\"https://houbb.github.io\\"}]}"],["meta",{"property":"og:url","content":"https://houbb.github.io/awesome-ai-coding/posts/learn-llms/2025-11-03-dive-into-llms-05-pytorch-01-intro.html"}],["meta",{"property":"og:site_name","content":"è€é©¬å•¸è¥¿é£"}],["meta",{"property":"og:title","content":"dive-into-llms-05-PyTorch å…¥é—¨ä»‹ç»"}],["meta",{"property":"og:description","content":"èƒŒæ™¯ https://pytorch.org/ chat æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘æ¥ç³»ç»Ÿã€æ˜“æ‡‚åœ°å¸®ä½ ä»‹ç»ä¸€ä¸‹ PyTorch â€”â€” å®ƒæ˜¯å‡ ä¹æ‰€æœ‰å¤§æ¨¡å‹ï¼ˆLLMï¼‰å¼€å‘è€…éƒ½è¦æŒæ¡çš„æ ¸å¿ƒæ¡†æ¶ã€‚ ğŸ’¡ ä¸€ã€PyTorch æ˜¯ä»€ä¹ˆï¼Ÿ PyTorch æ˜¯ä¸€ä¸ª åŸºäº Python çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œç”± Facebookï¼ˆç°åœ¨çš„ Metaï¼‰AI ç ”ç©¶é™¢åœ¨ 2016 å¹´å‘å¸ƒã€‚ å®ƒä¸»è¦..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-27T05:15:15.000Z"}],["meta",{"property":"article:tag","content":"learn-note"}],["meta",{"property":"article:tag","content":"ai"}],["meta",{"property":"article:published_time","content":"2025-11-03T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-27T05:15:15.000Z"}]]},"git":{"createdTime":1766812269000,"updatedTime":1766812515000,"contributors":[{"name":"bbhou","username":"bbhou","email":"1557740299@qq.com","commits":3,"url":"https://github.com/bbhou"}]},"readingTime":{"minutes":3.02,"words":905},"filePathRelative":"posts/learn-llms/2025-11-03-dive-into-llms-05-pytorch-01-intro.md","excerpt":"\\n<p><a href=\\"https://pytorch.org/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://pytorch.org/</a></p>\\n<h1>chat</h1>\\n<h2>æ˜¯ä»€ä¹ˆï¼Ÿ</h2>\\n<p>æˆ‘æ¥ç³»ç»Ÿã€æ˜“æ‡‚åœ°å¸®ä½ ä»‹ç»ä¸€ä¸‹ <strong>PyTorch</strong> â€”â€” å®ƒæ˜¯å‡ ä¹æ‰€æœ‰å¤§æ¨¡å‹ï¼ˆLLMï¼‰å¼€å‘è€…éƒ½è¦æŒæ¡çš„æ ¸å¿ƒæ¡†æ¶ã€‚</p>\\n<hr>\\n<h2>ğŸ’¡ ä¸€ã€PyTorch æ˜¯ä»€ä¹ˆï¼Ÿ</h2>\\n<blockquote>\\n<p>PyTorch æ˜¯ä¸€ä¸ª <strong>åŸºäº Python çš„æ·±åº¦å­¦ä¹ æ¡†æ¶</strong>ï¼Œç”± Facebookï¼ˆç°åœ¨çš„ Metaï¼‰AI ç ”ç©¶é™¢åœ¨ 2016 å¹´å‘å¸ƒã€‚<br>\\nå®ƒä¸»è¦ç”¨äºï¼š</p>\\n<ul>\\n<li><strong>æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹</strong></li>\\n<li><strong>è¿›è¡Œ GPU åŠ é€Ÿè®­ç»ƒ</strong></li>\\n<li><strong>å®ç°çµæ´»çš„ç§‘å­¦è®¡ç®—å’Œè‡ªåŠ¨å¾®åˆ†</strong></li>\\n</ul>\\n</blockquote>","autoDesc":true}');export{r as comp,d as data};
