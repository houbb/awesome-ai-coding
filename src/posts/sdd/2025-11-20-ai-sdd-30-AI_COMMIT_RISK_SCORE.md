---
title: AI SDD 开发规范-30-AI 代码提交风险评估规范（In-Execution Risk Scoring）
categories: [AI]
tags: [ai, sdd, sh]
published: true
---


# AI_COMMIT_RISK_SCORE

它对应你体系中的 **「事内」层** ——**在 AI 已经开始产出代码、但尚未合并之前，对“这次改动本身有多危险”做量化判断**。

> 如果说
>
> * **Decision Authority** 解决的是「AI有没有权这么干」
> * **Gate** 解决的是「结果对不对」
>
> 那么 **Commit Risk Score** 解决的是：
> **「即使是合法行为，这次改动值不值得信任？」**

---

# AI_COMMIT_RISK_SCORE.md

**AI 代码提交风险评估规范（In-Execution Risk Scoring）**

---

## 0. 文档目标（Purpose）

本规范用于在 **AI 编码执行过程中 / 提交前**：

* 对每一次 AI Commit 进行 **结构化风险评估**
* 给出一个 **可量化的风险分数（0–100）**
* 驱动：

  * Gate 严格度
  * 人工介入级别
  * 是否允许自动合并

> **不是判断“对不对”，而是判断“敢不敢让它过”。**

---

## 1. 风险评分总览（Score Overview）

```md
风险分数范围：0 ～ 100
```

| 分数区间   | 风险等级 | 建议处理                |
| ------ | ---- | ------------------- |
| 0–20   | 极低   | 可自动合并               |
| 21–40  | 低    | 轻量人工 Review         |
| 41–60  | 中    | 强制人工 Review         |
| 61–80  | 高    | 人工 Review + 扩展 Gate |
| 81–100 | 极高   | 禁止自动合并              |

---

## 2. 风险评估维度（Risk Dimensions）

### 2.1 变更范围风险（Change Scope）

```md
- 修改文件数量
- 跨模块变更
- 是否涉及公共 / 核心模块
```

评分示例：

| 情况       | 分值  |
| -------- | --- |
| 单文件、局部修改 | +5  |
| 多文件、同模块  | +15 |
| 跨模块      | +30 |

---

### 2.2 行为语义风险（Behavioral Impact）

```md
- 是否改变对外 API 行为
- 是否改变业务流程分支
- 是否影响异常 / 边界行为
```

| 情况     | 分值  |
| ------ | --- |
| 无行为变化  | +0  |
| 行为细节变化 | +20 |
| 行为语义变化 | +40 |

---

### 2.3 数据与状态风险（Data & State）

```md
- 是否读写数据库
- 是否影响状态一致性
- 是否涉及缓存 / 并发
```

| 情况        | 分值  |
| --------- | --- |
| 纯计算 / 无状态 | +0  |
| 状态读写      | +20 |
| 持久化数据修改   | +40 |

---

### 2.4 决策权限风险（Decision Authority）

> **直接绑定 `AI_DECISION_AUTHORITY.md`**

```md
本次 Commit 涉及的最高决策等级：
- L3 → +0
- L2 → +10
- L1 → +30
- L0 → +100（直接拒绝）
```

---

### 2.5 AI 行为异常风险（AI Behavior）

```md
- 是否存在“顺手改”
- 是否超出 Snapshot 范围
- 是否出现未声明假设
```

| 情况    | 分值  |
| ----- | --- |
| 严格按设计 | +0  |
| 轻微发散  | +15 |
| 明显越界  | +35 |

---

### 2.6 验证覆盖风险（Validation Coverage）

```md
- 是否新增 / 更新单测
- 测试是否覆盖关键路径
- Gate 是否全部通过
```

| 情况   | 分值  |
| ---- | --- |
| 单测充分 | -20 |
| 单测不足 | +10 |
| 无单测  | +30 |

---

## 3. 总分计算公式（Reference）

```text
Commit Risk Score =
  Scope
+ Behavior
+ Data
+ Decision
+ AI Behavior
+ Validation
```

> **允许负分项（如测试充分）用于风险抵消**

---

## 4. 风险分数 → 行为映射（Action Mapping）

```md
Score ≤ 20：
- 自动合并
- 简要记录

Score 21–40：
- 人工 Review（1 人）
- 标准 Gate

Score 41–60：
- 强制 Review（≥2 人）
- 扩展测试 Gate

Score ≥ 61：
- 禁止自动合并
- 进入 Retrospective
```

---

## 5. 执行期强制声明（Mandatory Disclosure）

> **AI 在提交前必须输出：**

```md
- 本次 Commit Risk Score：XX
- 风险主要来源：
- 是否建议人工介入：是 / 否
```

---

## 6. 与 Gate / Retrospective 的联动

```text
High Risk Commit
      ↓
Gate 加严
      ↓
若失败
      ↓
Retrospective
      ↓
规则 / 权限 / Score 权重调整
```

---

## 7. 典型反模式（Anti-Patterns）

```md
- 低分但改动巨大（评分模型缺失）
- 高分但无风险（权重失真）
- AI 不给分数直接提交（流程违规）
```

---

## 8. 体系原则（必须遵守）

> **我们不信“这次应该没事”，
> 我们只信“这次风险被量化了”。**

---

## 一句话定位（非常重要）

> **AI_COMMIT_RISK_SCORE 不是限制 AI，
> 而是把“直觉风险”变成“系统理性”。**

---

### 给你一个体系级判断

到这一层为止，你已经完成了：

* **权限（能不能做）**
* **风险（敢不敢合）**
* **Gate（对不对）**
* **复盘（怎么变聪明）**

这是一个**真正可规模化使用 AI 编码的工程闭环**。

# 参考资料

